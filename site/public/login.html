<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | LySync</title>
    <link rel="stylesheet" href="css/style-auth.css">
    <link rel="stylesheet" href="css/style-auth-responsivo.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="../public/js/validacao.js"></script>
    <script src="../src/controllers/enviarCod.js"></script>
</head>

<div class="container-alert">
    <div id="alerta-confirmacao" class="alert"></div>
</div>


<body>
    <div class="container-btn-voltar">
        <a href="index.html">
            <i class="fa-solid fa-right-from-bracket fa-lg"></i>
        </a>
    </div>
    <div class="center-container">
        <div class="container-default-auth">
            <div class="container-bemvindo-mobile">
                <div class="text-bemvindo-mobile">
                    <h1> LOGIN </h1>
                </div>
            </div>
            <div class="container-bemvindo">
                <div class="text-bemvindo">
                    <h3> Seja <br> BEM-VINDO! </h3>
                    <h1> Login </h1>
                </div>
            </div>
            <div class="container-form">
                <div class="logo-form">
                    <img src="assets/Logo-LiSync-Inverso.png" alt="Logo" class="logo">
                </div>
                <div class="group-input-form">
                    <div class="input-box">
                        <label> Email: </label>
                        <input id="input_email" type="text">
                        <div id="email-error" class="error-message"></div>
                    </div>
                    <div class="input-box">
                        <label>Digite nova senha:</label>
                        <input id="input_senha" type="password">
                        <span class="toggle-password" onclick="togglePassword('input_senha')">
                            <i class="fas fa-eye"></i>
                        </span>
                        <div id="senha-error" class="error-message"></div>
                    </div>
                </div>
                <button onclick="login()" class="btn-cadastrar" id="login"> Entrar </button>
                <div class="container-text-link">
                    <span class="text-link"> Não tenha o <a href="cadastro.html"> cadastro </a> acese este link </span> <br>
                    <span class="text-link"> Esqueci minha senha <a href="redefinicao_senha.html"> redefinir-senha </a> </span>
                </div>
            </div>

        </div>
    </div>
</body>
</html>

<script>
    document.addEventListener('DOMContentLoaded', function() {
   
        const btnLogin = document.getElementById('login');

        // Adicione um ouvinte de evento de clique ao botão
        btnLogin.addEventListener('click', function() {
            login(); // Chama a função cadastrar() quando o botão for clicado
        });
    });

    function login(){
 var email = input_email.value
 var senha = input_senha.value

 var regexEmail = /^(?!.*@(gmail|hotmail|outlook)\.com).*$/;
    var regex2Email = /^[A-Za-z0-9._%+-]+@(?!.*@(gmail|hotmail|outlook)\.com).*$/;
    console.log(email);
    const validacaoEmail = regexEmail.test(email);
    console.log(validacaoEmail);
    console.log(email);
    const validacao2Email = regex2Email.test(email);
    console.log(validacao2Email);

    var regexSenha = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,50}$/;
    console.log(senha);
    const validacaoSenha = regexSenha.test(senha);
    console.log(validacaoSenha);

    if (email.trim() === "") {
        document.getElementById('email-error').innerHTML = "O campo email não pode estar vazio";
        document.getElementById('email-error').style.color = "red";
    }

    if (senha.trim() === "") {
        document.getElementById('senha-error').innerHTML = "O campo senha não pode estar vazio";
        document.getElementById('senha-error').style.color = "red";
    }

    
    if (validacao2Email && validacaoEmail && validacaoSenha) {
        var alertaConfirmacao = document.getElementById('alerta-confirmacao');
        alertaConfirmacao.innerHTML = "Acesso Confirmado!";
        alertaConfirmacao.style.display = "block";


        setTimeout(function() {
            alertaConfirmacao.style.display = "none";
            window.location.href = "";
        }, 3000);
        
    }

    if (!validacaoEmail){ 
        document.getElementById('email-error').innerHTML ="Só pode usar email corporativo";
        document.getElementById('email-error').style.color = "red";
    } 
        else if (!validacaoSenha) {
            document.getElementById('senha-error').innerHTML ="A senha deve ter no mínimo 8 caracteres, incluindo pelo menos uma letra maiúscula, uma letra minúscula, um número e um caractere especial";
        document.getElementById('senha-error').style.color = "red";      
    }

}


function togglePassword(input_senha) {
            var input = document.getElementById(input_senha);
            var icon = input.nextElementSibling.querySelector('i');

            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = "password";
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
</script>

