<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirmação Senha | LySync</title>
    <link rel="stylesheet" href="css/style-auth.css">
    <link rel="stylesheet" href="css/style-auth-responsivo.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>

<body>

    <div class="container-alert">
        <div id="alerta-confirmacao" class="alert"></div>
    </div>

    <div class="container-alert">
        <div id="alerta-erro" class="alertErro"></div>
    </div>

    <div class="container-btn-voltar">
        <a href="index.html">
            <i class="fa-solid fa-right-from-bracket fa-lg"></i>
        </a>
    </div>
    <div class="center-container">
        <div class="container-default-auth">
            <div class="container-bemvindo-mobile">
                <div class="text-bemvindo-mobile">
                    <h1> REDEFINIR SENHA </h1>
                </div>
            </div>
            <div class="container-bemvindo">
                <div class="text-bemvindo">
                    <h1> REDEFINIR </h1>
                    <h1> SENHA </h1>
                </div>
            </div>
            <div class="container-form">
                <div class="logo-form">
                    <img src="assets/Logo-LiSync-Inverso.png" alt="Logo" class="logo">
                </div>
                <div class="group-input-form">
                    <div class="input-box">
                        <label>Senha:</label>
                        <input id="novaSenha" type="password">
                        <span class="toggle-password" onclick="togglePassword('novaSenha')">
                            <i class="fas fa-eye"></i>
                        </span>
                        <div id="senha-error" class="error-message"></div>
                    </div>
                    <div class="input-box">
                        <label>Senha:</label>
                        <input id="confirmacaoSenha" type="password">
                        <span class="toggle-password" onclick="togglePassword('confirmacaoSenha')">
                            <i class="fas fa-eye"></i>
                        </span>
                        <div id="senha-error" class="error-message"></div>
                    </div>
                </div>
                <button onclick="redefinir()" class="btn-cadastrar" id="redefinir"> REDEFINIR </button>
                <div class="container-text-link">
                    <span class="text-link"> Retroceder para página de <a href="login.html"> login </a> </span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    function redefinir() {
        var novaSenha = document.getElementById('novaSenha').value;
        var confirmacaoSenha = document.getElementById('confirmacaoSenha').value;

        var regexSenha = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,50}$/;
        const validacaoSenha = regexSenha.test(novaSenha);
    
        if (novaSenha.trim() === "") {
        document.getElementById('senha-error').innerHTML = "O campo senha não pode estar vazio";
        document.getElementById('senha-error').style.color = "red";       
    }

    if (confirmacaoSenha.trim() === "") {
        document.getElementById('senha-error').innerHTML = "O campo confirmacaoSenha não pode estar vazio";
        document.getElementById('senha-error').style.color = "red";
        
    }

    if (!validacaoSenha) {
            document.getElementById('senha-error').innerHTML ="A senha deve ter no mínimo 8 caracteres, incluindo pelo menos uma letra maiúscula, uma letra minúscula, um número e um caractere especial";
            document.getElementById('senha-error').style.color = "red";
        }

        if (novaSenha === confirmacaoSenha && validacaoSenha == true) {
            var alertaConfirmacao = document.getElementById('alerta-confirmacao');
            alertaConfirmacao.innerHTML = "Redefinição Concluída!";
            alertaConfirmacao.style.display = "block";

            setTimeout(function () {
                alertaConfirmacao.style.display = "none";
                window.location.href = "login.html";
            }, 3000);
        } else {
            var alertaErro = document.getElementById('alerta-erro');
            alertaErro.innerHTML = "As senhas não coincidem!";
            alertaErro.style.display = "block";

            setTimeout(function () {
                alertaErro.style.display = "none";
            }, 3000);
        }
    }

    function togglePassword(novaSenha) {
            var input = document.getElementById(novaSenha);
            var icon = input.nextElementSibling.querySelector('i');

            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = "password";
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        function togglePassword(confirmacaoSenha) {
            var input = document.getElementById(confirmacaoSenha);
            var icon = input.nextElementSibling.querySelector('i');

            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = "password";
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
</script>
